"use strict";!function(e){function r(e){var r={maps:{}};return r.urls={api:"https://sbxcloud.com/api",update_password:"/user/v1/password",login:"/user/v1/login",register:"/user/v1/register",row:"/data/v1/row",find:"/data/v1/row/find",update:"/data/v1/row/update",delete:"/data/v1/row/delete",uploadFile:"/content/v1/upload",addFolder:"/content/v1/folder",folderList:"/content/v1/folder",send_mail:"/email/v1/send",payment_customer:"/payment/v1/customer",payment_card:"/payment/v1/card",payment_token:"/payment/v1/token",password:"/user/v1/password/request"},r.toMap=function(e,t,n){r.maps[t]||(r.maps[t]={});for(var o=0;o<e.length;o++)r.maps[t][e[o][n]]=e[o];return r.maps[t]},r.getHeaders=function(){return r.headers},r.upper=function(e){return null==e?"":e.toUpperCase()},r.setHeaders=function(e){r.headers={Authorization:"Bearer "+e,"App-Key":r.app_key.dev}},r.request=function(t){return e({method:t.method,url:r.urls.api+t.url,params:t.params||null,data:t.data||null,headers:r.getHeaders()}).then(function(e){return e},function(e){return e})},r.method={get:function(e,r){return $sbxCommonSrv.request({method:"GET",url:e,params:r})},post:function(r,t){return e({method:"POST",url:r,params:t})},query:function(r,t){return e({method:"POST",url:r,data:t})},put:function(r,t){return e({method:"PUT",url:r,data:t})}},r.loadPage=function(e,t,n,o){console.count?console.count("loadPage--\x3e"+e.row_model):console.log("loadPage--\x3e"+e.row_model,t),e.page=t,r.method.query(r.urls.find,e).then(function(e){var r=e.data;r.success?n(r):o(new Error(r.error))})},r.loadAllPages=function(e,t,n){if(e.page=1,e.size=100,!e.where)return void n(new Error("Invalid value: "+value));async.waterfall([function(t){var n=[],o={};r.loadPage(e,1,function(e){n=n.concat(e.results),e.fetched_results&&(o=e.fetched_results),t(null,n,e.total_pages,o)},function(e){t(e)})},function(t,n,o,a){var u=o;if(n<2)return void a(null,t,u);for(var s=[],l=2;l<=n;l++)s.push(l);async.eachSeries(s,function(n,o){r.loadPage(e,n,function(e){e.fetched_results&&Object.keys(e.fetched_results).forEach(function(r){u.hasOwnProperty(r)||(u[r]={});for(var t in e.fetched_results[r])e.fetched_results[r].hasOwnProperty(t)&&(u[r][t]=e.fetched_results[r][t])}),t=t.concat(e.results),o(null)},function(e){o(e)})},function(e){a(e,t,u)})}],function(e,r,o){e?n(e):t({results:r,fetched_results:o})})},r.queryBuilder=QueryBuilder,r.register=function(e,t,n){r.method.get(r.urls.register,e).then(function(e){var e=r.response.get.data;e.success?t(e):n("Cannot register user")})},r.login=function(r,t,n){e.get(common.urls.api+common.urls.login,{params:r}).then(function(e){var r=e.data;r.success&&t(r)})},r.checkPicture=function(e,r){var t=$q.defer();r.def=t;var n=new Image;return n.onerror=function(){t.resolve(!1)},n.onload=function(){t.resolve(!0)},n.src=e,t.promise},r.onSuccessDefault=function(e){console.log(e)},r.onErrorDefault=function(e){console.error?console.error(e):console.log(e)},r}e.module("sbx.cloud-nglib",[]).factory("sbxCommonSrv",["$http",r])}(angular);
//# sourceMappingURL=sbx.cloud-nglib.js.map
